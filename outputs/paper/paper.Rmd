---
title: "Homocides in Toronto Neighbourhoods from 2004-2020"
author: 
  Justin Teng 
thanks: "Code and data are available at: https://github.com/justinteng1999/starter_folder-main"
date: "06 February 2022"
abstract: "Understanding the datasets of homicides in The City of Toronto Neighbourhoods are crucial for determining the distribution of police resources among the neighborhoods. From the City of Toronto Open Portal, we obtain and analyze this data of homicide cases in Toronto neighbourhoods between the years of 2004-2020. We find that homicide occurrences have been slowly increasing each year from 2011 to 2020. Also, certain neighbourhoods in Toronto have relatively higher numbers of homicide occurrences. Moreover, there is a significant large percentage of homicides that are firearm-related. Our findings have implication for allocation of police surveillance, police patrols, and the management of weapons registration."
output:
  bookdown::pdf_document2
toc: FALSE
bibliography: references.bib
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(palmerpenguins)
```

# Introduction

As the largest city in Canada, Toronto has a population of 6.5 million people. However, from 2002-2020, it is also the Metropolitan Area with the most homicide cases in Canada each year according to Statistics Canada[@citehomicideincanada]. Despite that overall police-reported crime in Canada has decreased in 2020, there are still 743 homicide cases being reported by the police.  Toronto had the highest number of homicides of all Metropolitan Areas in 2020 with 105 victims, which was a decrease of 25 victims from 2019 [@citehomicideincanada2020]
Therefore, the analysis on this dataset of homicides in the neighbourhoods of Toronto from the year of 2004 to 2020 will be crucial in terms of understanding the occurrences of homicide over the years. 

This dataset includes information on all reported homicides from 2004 to 2020 in the 140 Neighbourhoods of Toronto. However, the numbers by Division and Neighbourhood may not reflect the exact time or count of occurrences reported within these geographies, for the location of crime occurrences have been deliberately offset to the nearest road intersection for the privacy of parties involved in the occurrence [@citeopendatatoronto]. From the data, we find that homicide occurrences have been slowly increasing each year from 2011 to 2020. Also, certain neighbourhoods in Toronto have relatively higher number of homicide occurrences. Furthermore, 52% of the homicide cases are firearm-related. 

Our findings have important implication for the allocation of police surveillance and patrols among different neighbourhoods in Toronto. For instance, neighbourhoods with the highest number of homicide occurrences, such as  Mosspark and Malvern, should have increase their police surveillance and patrol frequency. Also, due to the significant high percentage of firearms involvement in homicides, we know it is necessary to improve the management of weapons registration and the firearm-related laws. 


The remainder of this paper is: Section \@ref(data) explains the data. Section \@ref(results) covers results

# Data

In order to better understand and analyze occurrences of homicides over the years among different neighbourhoods in Toronto, I obtain the dataset from the City of Toronto open Data Portal, using the 'opendatatoronto' package[@citeopendatatoronto] and statistical programming language R [@citeR]. The raw data includes all reported homicides in 140 neighbourhoods within the Greater Toronto Area from year 2004-2020, as well as the type of homicide in each case. However, there are also some variables that are not necessary for our analysis, such as Event Unique Id, Division ID, Object ID, Hood ID and Geometry. Therefore, I first cleaned out the unnecessary variables and extract the required data for the exploratory data analysis. During this process, I used R [@citeR], tidyverse[@citeTidyverse] and dplyr[@citedplyr].

```{r clean_data, echo = FALSE, warning=FALSE, message=FALSE}
library(tidyverse)
library(knitr)
library(dplyr)

homicide <- 
  read.csv(here::here("inputs/data/homocide.csv"))

# Clean out the unnecessary variables
cleaned_homicide_data <-
  homicide |>
  select(Occurrence_year, 
         Homicide_Type,
         Neighbourhood)
```

Then show an extract of the dataset (Table \@ref(tab:dataextract)) .

```{r dataextract, echo = FALSE}

cleaned_homicide_data |> 
  select(Occurrence_year, Neighbourhood, Homicide_Type) |>
  slice(1:10) |> 
  kable(
    caption = "First ten rows of a dataset of a dataset that shows homicide occurrence",
    col.names = c("Year of Occurrences,",
                  "Neighborhood of Occurences", "Type of Homicide"),
    digits = 1,
    booktabs = TRUE,
    linesep = ""
  )
```


Paragraph or two more about Table  \@ref(tab:dataextract).



We are interested in the number of homicide occurrence each year from 2004-2020, and the neighbourhoods with high number of homicide cases, as well as the type of homicide in each case. This is the measure of how homicide cases are distributed and has implications for allocation of police resources.


```{r, echo=FALSE}

# Make tibble for individual variable

tibble_occurrence_year <- 
  tibble(cleaned_homicide_data) |>
  count(Occurrence_year)

tibble_neighbourhood <- 
  tibble(cleaned_homicide_data) |>
  count(Neighbourhood)

tibble_homicide_type <- 
  tibble(cleaned_homicide_data) |>
  count(Homicide_Type)

```

(Figure \@ref(fig:homicideYear)) shows the number of homicide occurrence each year from 2004-2020.

```{r homicideYear, fig.cap = "Homicide Occurrences each Year (2004-2020)", echo = FALSE, warning=FALSE, message=FALSE}

tibble_occurrence_year |> 
  ggplot(aes(x = Occurrence_year, y = n, fill = n)) +
  geom_col() +
  xlab("Year of Homicide Occurrences") +
  ylab("Number of Homicide Cases") +
  theme_set(theme_bw())

```

(Figure \@ref(fig:homicideNeighbourhood)) shows the top 10 neighbourhoods with most number of homicide cases

```{r homicideNeighbourhood, fig.cap = "Top 10 Neighbourhoods with Most Homicide Occurrences (2004-2020)", echo=FALSE, warning=FALSE, message=FALSE}

tibble_neighbourhood |> 
  group_by(Neighbourhood, n) |>
  arrange(desc(n)) |>
  head(10) |>
  ggplot(aes(x = reorder(Neighbourhood, n), 
             y = n, 
             fill = n)) +
  geom_col() +
  xlab("Neighbourhoods") +
  ylab("Number of Homicide Cases") +
  coord_flip() +
  theme_set(theme_bw())
```

(Figure \@ref(fig:homicidetype)) shows number of each homicide type

```{r homicidetype, fig.cap = "Type of Homicide Cases (2004-2020", echo=FALSE, warning=FALSE, message=FALSE}

tibble_homicide_type |>
  ggplot(aes(reorder(x = Homicide_Type, n),
             y = n, 
             fill = Homicide_Type)) +
  geom_col() +
  xlab("Type of Homicide") +
  ylab("Number of Homicide Cases") +
  theme_set(theme_bw())
```


# Results

# Discussion

## First discussion point

If my paper were 10 pages, then should be be at least 2.5 pages. The discussion is a chance to show off what you know and what you learnt from all this. 

## Second discussion point

## Third discussion point

## Weaknesses and next steps

Weaknesses and next steps should also be included.

\newpage

\appendix

# Appendix {-}


# Additional details


\newpage


# References


